@using System.Drawing
@model PrintStat.Models.ViewModels.DeviceConsumableView
<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"> </script>

<script type="text/javascript">
    $(document).ready(function() {
        $('#datetimepicker,#datetimepicker1,#datetimepicker2').datetimepicker(
        {
            format: 'd.m.Y H:i',
            lang: 'ru' //,
        });

    });

    function setTime(variant, dateTime, idDevCon) {
        $.post("/Device/SetTimeConsDev/", { idDevCon: idDevCon, dateTime: dateTime, variant: variant });

    }

</script>

<input id="datetimepicker" type="text" style="width: 150px;">

<h4>
    Используемые в настоящий момент комплектующие
</h4>





    <table>
        <thead>
            <tr>

                <th>Наименование комплектующего</th>
                <th>Дата добавления</th>
                <th>Дата прекращения работы</th>
                <th>Действие</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.AllDevCons != null)
            {
                foreach (var item in Model.AllDevCons.Where(p => p.Uses == true))
                {
                    <tr>

                        <td>
                            @item.Type @item.Name
                        </td>

                        <td id="install">
                            @*@item.DateInstalled*@
                            <input id="datetimepicker1" type="text" style="width: 150px;" value="@item.DateInstalled.ToString()" onblur=" setTime(1,this.value,@item.ID)">
                        </td>

                        <td id="end">
                            @*@item.DateEnd*@
                            @{
                    if (item.DateEnd != null)
                    {
                        <input id="datetimepicker2" type="text" style="width: 150px;" value="@item.DateEnd.ToString()" onblur=" setTime(2,this.value,@item.ID)">}
                            }
                        </td>

                        <td>
                            @if (item.DateEnd == null)
                            {

                                @Ajax.ActionLink(
                                    "Прекратить использование",
                                    "GetDeviceConsumble",
                                    "Device",
                                    new {deviceId = @Model.deviceID, id = @item.ID, option = 1},
                                    new AjaxOptions {UpdateTargetId = "partialDevConsumable"}
                                    )
                            }
                            else
                            {

                                @Ajax.ActionLink(
                                    "Заменить",
                                    "GetDeviceConsumble",
                                    "Device",
                                    new {deviceId = @Model.deviceID, id = @item.ID, option = 2},
                                    new AjaxOptions {UpdateTargetId = "partialDevConsumable"}
                                    )
                            }
                        </td>


                    </tr>

                }
            }
        </tbody>
    </table>

    <h4>
        Комплектующие, вышедшие из эксплуатации
    </h4>
      <table>
          <thead>
          <tr>
              <th>Наименование комплектующего</th>
              <th>Дата добавления</th>
              <th>Дата прекращения работы</th>
              @*<th>Счетчик бумаги на задания</th>
                <th>Счетчик бумаги SNMP</th>*@
          </tr>
          </thead>
          <tbody>

          @if (Model.AllDevCons.Where(p => p.Uses == false) != null)
          {
              foreach (var item in Model.AllDevCons.Where(p => p.Uses == false))
              {
                  <tr>
                      <td>
                          @item.Type @item.Name
                      </td>

                      <td>
                          @item.DateInstalled
                      </td>

                      <td>
                          @item.DateEnd
                      </td>

                      @*<td>
                            @item.Count
                        </td>
                        <td>
                            @item.CountSnmp
                        </td>*@
                  </tr>
              }
          }
          </tbody>
      </table>
 

